# 📍 Excel 檔案相對位置設定指南

## 🎯 檔案名稱
請確保您的 Excel 檔案命名為：
```
DUT_list.xlsx
```

## 📂 建議放置位置

### 方案 1：專案根目錄（推薦）
```
📁 0710Tool Box/
├── 📄 DUT_list.xlsx          ← 放在這裡
├── 📁 pages/
│   └── 📁 firmware/
│       └── 📄 redmine.html
└── 📄 其他檔案...
```

### 方案 2：與 redmine.html 同目錄
```
📁 pages/firmware/
├── 📄 redmine.html
└── 📄 DUT_list.xlsx          ← 放在這裡
```

## 🔄 自動重新載入機制

系統會在以下情況自動重新載入 Excel 資料：

1. **首次開啟頁面**：頁面載入時自動讀取
2. **Tab 重新可見**：切換到其他 Tab 後再回來時
3. **視窗重新聚焦**：點擊其他應用程式後再回來時
4. **手動重新載入**：點擊 🔄 重新載入按鈕

## 🛡️ 防護機制

- **3 秒間隔限制**：避免頻繁重複載入
- **載入狀態檢查**：防止同時執行多次載入
- **資料變化檢測**：只有資料真正改變才會顯示更新訊息

## 📊 使用流程

1. **準備 Excel 檔案**
   ```
   將 DUT_list.xlsx 放在專案根目錄
   ```

2. **開啟頁面**
   ```
   開啟 pages/firmware/redmine.html
   系統自動載入最新資料
   ```

3. **修改資料**
   ```
   在其他程式中修改 DUT_list.xlsx
   儲存檔案
   ```

4. **即時更新**
   ```
   切換到其他 Tab 再回來
   或點擊 🔄 重新載入按鈕
   系統會自動讀取最新資料
   ```

## 🔍 系統搜尋順序

系統會按以下順序搜尋 Excel 檔案：
1. `./DUT_list.xlsx` (當前頁面同目錄)
2. `../DUT_list.xlsx` (上層目錄，專案根目錄)
3. `../../DUT_list.xlsx` (上兩層目錄)
4. `DUT_list.xlsx` (相對當前位置)
5. `data/DUT_list.xlsx` (data 資料夾)

## ⚠️ 注意事項

- 檔案名稱必須是 `DUT_list.xlsx`（區分大小寫）
- 確保 Excel 檔案格式正確（第一行為標題行）
- 建議將檔案放在專案根目錄以獲得最佳載入速度

---

💡 **最佳實務**：將 `DUT_list.xlsx` 放在專案根目錄，每次修改後系統會在您切換 Tab 時自動重新載入最新資料。
