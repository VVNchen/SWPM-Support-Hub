# Redmine 功能修復報告

## 🐛 問題描述
用戶反應 "redmine打不開"，經檢查發現以下問題：

1. **缺少 SheetJS 庫**: `index-vue-direct.html` 沒有載入 SheetJS，導致 Excel 讀取功能無法使用
2. **初始化函數缺失**: Vue.js 嘗試調用不存在的全局函數
3. **事件綁定問題**: Redmine 功能的事件處理程序沒有正確綁定

## 🔧 修復內容

### 1. 添加 SheetJS 庫載入
**文件**: `index-vue-direct.html`
```html
<!-- 新增 -->
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
```

### 2. 重構 Redmine 初始化邏輯
**文件**: `direct-vue-app.js`

#### 2.1 改進錯誤處理
- 添加更詳細的錯誤訊息
- 提供重新載入按鈕

#### 2.2 新增手動初始化函數
- `manuallyInitializeRedmine()`: 手動初始化 Redmine 功能
- `bindRedmineEvents()`: 綁定事件處理程序

#### 2.3 改進 Tab 切換處理
- 當切換到 Redmine tab 時自動重新初始化

### 3. 創建測試工具
**新增文件**:
- `test-server.py`: 本地測試服務器
- `test-redmine-fix.html`: 功能測試頁面

## 🚀 使用方法

### 方法一：直接開啟（推薦）
1. 雙擊開啟 `index-vue-direct.html`
2. 點擊左側的 "🚀 Firmware Release"
3. 點擊上方的 "redmine" 標籤
4. 產品選單應該會自動載入備用資料

### 方法二：使用本地服務器（完整功能）
1. 開啟 PowerShell 或命令提示字元
2. 切換到專案目錄：
   ```powershell
   cd "d:\OneDrive - ASUS\Desktop\0714Tool Box"
   ```
3. 執行測試服務器：
   ```powershell
   python test-server.py
   ```
4. 在瀏覽器中開啟：`http://localhost:8000/index-vue-direct.html`

### 功能測試
開啟 `test-redmine-fix.html` 進行功能測試：
- 檢查依賴庫是否正確載入
- 驗證文件存在性
- 測試 Redmine 載入功能
- 測試產品選單功能

## 🎯 修復後的功能

### Redmine 功能現在包含：
1. **產品選單**: 自動載入備用產品資料
2. **Firmware 路徑**: 根據選擇的產品自動填入
3. **事件處理**: 產品變更時自動更新 Firmware 路徑
4. **錯誤處理**: 當載入失敗時顯示錯誤訊息和重試選項

### 備用產品資料包含：
- EBM68, EBA63, EBG15, EBG19
- GT10, GT11, GT12
- RT-AX86U, RT-AX88U, RT-AX89X, RT-AX92U, RT-AX95Q, RT-AX96U
- ZenWiFi-AX6600, ZenWiFi-BE11000
- TUF-AX3000, TUF-AX5400
- RT-AC86U, RT-AC88U, RT-AC3100

## ⚠️ 注意事項

1. **Excel 功能**: 需要本地服務器才能載入 Excel 文件
2. **網路連接**: 需要網路連接載入 SheetJS 和 Vue.js
3. **瀏覽器兼容**: 建議使用現代瀏覽器 (Chrome, Firefox, Edge)

## 🔍 故障排除

### 如果 Redmine 仍無法使用：
1. 檢查瀏覽器控制台是否有錯誤訊息
2. 確認網路連接正常（需要載入外部庫）
3. 嘗試使用 `test-redmine-fix.html` 進行診斷
4. 使用本地服務器而非直接開啟文件

### 常見錯誤：
- **CORS 錯誤**: 使用本地服務器解決
- **庫載入失敗**: 檢查網路連接
- **文件不存在**: 確認 `pages/firmware/redmine.html` 存在
